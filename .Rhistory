#print(true_predictions)
#prediction(test_predictions, i$Direction)
}
for (i in vect) {
#print(i)
#print(final_df%>%anti_join(i, on = 'RegionID'))
training_data <- final_df %>% anti_join(i, on='RegionID')
cur_forest <- randomForest(Direction~., data=training_data %>% select(-RegionID))
cur_tree <- tree(Direction~., data=training_data %>% select(-RegionID))
test_predictions_forest <- predict(cur_forest, newdata=i %>% select(-RegionID))
test_predictions_tree <- predict(cur_tree, newdata=i %>% select(-RegionID))
print(str_split(test_predictions_tree, " "))
#table(pred=test_predictions_forest, observed=i$Direction)
#table(pred=test_predictions_tree, observed=i$Direction)
#true_predictions <- as.vector(i$Direction)
#print(test_predictions)
#print(true_predictions)
#prediction(test_predictions, i$Direction)
}
tempdir()
library(rvest)
library(tidyverse)
coaches <- read.csv('csv/coaches.csv')
divisions <- read.csv('csv/divisions.csv')
leagues <- read.csv('csv/leagues.csv')
allstars <- read.csv('csv/league_history_all_star.csv')
players <- read.csv('csv/players.csv')
awards <- read.csv('csv/players_awards.csv')
batting_stats <- read.csv('csv/players_career_batting_stats.csv')
pitching_stats <- read.csv('csv/players_career_pitching_stats.csv')
teams <- read.csv('csv/teams.csv')
team_history_record <- read.csv('csv/team_history_record.csv')
team_history_financials <- read.csv('csv/team_history_financials.csv')
lahman <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(ggplot2)
hits_by_year <- players %>% inner_join(batting_stats, by = 'player_id') %>% filter(split_id == 1,h > 50) %>% select(player_id,first_name, last_name, sim_hits = h ,year_id = year)
hits_difference <- hits_by_year %>% inner_join(lahman_hits, on = c('first_name', 'last_name', 'year_id'))
hits_difference['dif_hits'] <- hits_difference['sim_hits'] - hits_difference['hits']
hits_difference %>% ggplot(mapping=aes(x=dif_hits)) + geom_histogram(binwidth = 5)
View(lahman_k)
View(lahman_k)
View(lahman_k)
View(lahman_k)
View(lahman_k)
View(test_frame)
View(pitching_stats)
ootp_k <- pitching_stats %>% filter(year >= 2000 && k > 50)
View(ootp_k)
ootp_k <- pitching_stats %>% filter(year >= 2000, k > 50)
View(ootp_k)
ootp_k <- pitching_stats %>% filter(year >= 2000, k > 50) %>% inner_join(players, on=player_id)
View(ootp_k)
View(players)
ootp_k <- pitching_stats %>% filter(year >= 2000, k > 50) %>% inner_join(players, on=player_id) %>% select(first_name, last_name, k, year)
final_k <- ootp_k %>% inner_join(lahman_k, on = c('first_name', 'last_name', 'year_id'))
View(final_k)
View(ootp_k)
View(lahman_k)
ootp_k <- pitching_stats %>% filter(year >= 2000, k > 50) %>% inner_join(players, on=player_id) %>% select(first_name, last_name, k, year)
final_k <- ootp_k %>% inner_join(lahman_k, on = c('first_name', 'last_name', 'year_id'))
View(final_k)
ootp_k <- pitching_stats %>% filter(year >= 2000, k > 50) %>% inner_join(players, on=player_id) %>% select(first_name, last_name, k, year)
ootp_k <- pitching_stats %>% filter(split_id = 1, k > 50) %>% inner_join(players, on=player_id) %>% select(first_name, last_name, k, year)
ootp_k <- pitching_stats %>% filter(split_id == 1, k > 50) %>% inner_join(players, on=player_id) %>% select(first_name, last_name, k, year)
View(ootp_k)
final_k <- ootp_k %>% inner_join(lahman_k, by = c('first_name', 'last_name', 'year_id'))
View(final_k)
final_k <- ootp_k %>% inner_join(lahman_k, on = c('first_name', 'last_name', 'year_id'))
ootp_k <- pitching_stats %>% filter(split_id == 1, k > 50) %>% inner_join(players, on=player_id) %>% select(first_name, last_name, k, year)
final_k <- ootp_k %>% inner_join(lahman_k, on = c('first_name', 'last_name', 'year_id'))
k_by_year <- players %>% inner_join(batting_stats, by = 'player_id') %>% filter(split_id == 1,h > 50) %>% select(player_id,first_name, last_name, sim_k = h ,year_id = year)
View(k_by_year)
View(team_history_record)
View(team_history)
View(lahman_pos)
size <- nrow(traing_set)
library(rvest)
library(tidyverse)
coaches <- read.csv('csv/coaches.csv')
library(rvest)
library(tidyverse)
coaches <- read.csv('csv/coaches.csv')
divisions <- read.csv('csv/divisions.csv')
leagues <- read.csv('csv/leagues.csv')
allstars <- read.csv('csv/league_history_all_star.csv')
players <- read.csv('csv/players.csv')
awards <- read.csv('csv/league_history.csv')
batting_stats <- read.csv('csv/players_career_batting_stats.csv')
pitching_stats <- read.csv('csv/players_career_pitching_stats.csv')
teams <- read.csv('csv/teams.csv')
team_history_record <- read.csv('csv/team_history_record.csv')
team_history_financials <- read.csv('csv/team_history_financials.csv')
lahman <- DBI::dbConnect(RSQLite::SQLite(), "lahman2016.sqlite")
library(ggplot2)
hits_by_year <- players %>% inner_join(batting_stats, by = 'player_id') %>%
filter(split_id == 1,h > 50) %>% select(player_id,first_name, last_name, sim_hits = h ,year_id = year)
hits_difference <- hits_by_year %>% inner_join(lahman_hits, on = c('first_name', 'last_name', 'year_id'))
hits_difference['dif_hits'] <- hits_difference['sim_hits'] - hits_difference['hits']
hits_difference %>% ggplot(mapping=aes(x=dif_hits)) + geom_histogram(binwidth = 5)
sim_pos <- team_history_record %>% inner_join(teams, by = 'team_id') %>%
select(team_id,historical_id, pos, year) %>% group_by(historical_id) %>% summarize(sim_pos=mean(pos))
diff_pos <- sim_pos %>% inner_join(lahman_pos, by = c("historical_id"="teamID"))
diff_pos['diff'] <- - diff_pos$sim_pos + diff_pos$real_pos
diff_pos %>% select(diff,historical_id) %>% arrange(desc(diff))
diff_pos %>% summarize(sd=sd(diff), mean=mean(diff))
sim_awards <- awards %>% inner_join(players, by = c("best_hitter_id" = "player_id"))
sim_awards$league <- ifelse(sim_awards$sub_league_id == 0, 'AL', 'NL')
sim_awards %>% select(first_name, last_name, league, year)
print (sim_awards %>% left_join(pitching_stats, by = c("best_hitter_id" = "player_id", "year" = "year")) %>% filter(split_id == 1) %>% select(first_name, last_name) %>% nrow())
trimed_batting_stats <- players %>% left_join (batting_stats, by=c('player_id'='player_id'))  %>% filter (split_id == 1) %>% filter(position.x != 1) %>% select(year, player_id, first_name, last_name, ab, h, k ,pa, d, t, hr, r, rbi, sb, cs, bb, ibb) %>% filter(ab!=0)
trimed_batting_stats <- trimed_batting_stats %>% mutate(BA=h/ab, OBP=(h+bb+ibb)/(ab+bb+ibb), SLG=(h+d+2*t+3*hr)/ab, HRpercent=hr/ab, BBpercent=(bb+ibb)/pa, Kpercent=k/pa)
trimed_batting_stats <- trimed_batting_stats %>% mutate(ISO=SLG-BA)
trimed_batting_stats %>% arrange(desc(HRpercent)) %>% filter (ab > 300) %>% slice(1:10) %>% select(year,first_name,last_name, HRpercent, hr)
trimed_batting_stats %>% group_by(first_name, last_name) %>% summarize(avg_rbi = mean(rbi), num_years = n()) %>% arrange(desc(avg_rbi)) %>% head(n=10)
homers_by_year <- batting_stats %>% filter(split_id == 1) %>% group_by(year) %>% summarize(sim_homers=sum(hr))
homers_by_year %>% ggplot(mapping=aes(x=year,y=sim_homers)) + geom_point() + geom_line()
sim_and_real_hr_totals <- lahman_hr %>% left_join(homers_by_year, by=c('yearID'='year'))
sim_and_real_hr_totals %>% ggplot(mapping=aes(x=yearID,y=sim_homers-actual_homers)) + geom_point() + geom_line()
(sim_and_real_hr_totals$sim_homers-sim_and_real_hr_totals$actual_homers) %>% abs() %>% mean()
allstars
allstar_stats <- trimed_batting_stats %>% left_join (allstars, by=c("player_id"="all_star","year"))
allstar_stats$was_all_star <- ifelse (is.na(allstar_stats$all_star_pos),0,1)
allstar_stats_trimed <- allstar_stats %>% select(ab,h,d,t,hr,k,bb,ibb,pa,r,rbi,sb,BA,OBP,SLG,HRpercent,BBpercent,Kpercent,ISO,was_all_star)
library(dplyr)
library(broom)
library(ggplot2)
allstar_stats_trimed %>% select(BA,OBP,SLG) %>% sample_n(10)
allstar_stats_trimed <- allstar_stats_trimed %>% group_by(was_all_star)
traing_set <- allstar_stats_trimed %>% sample_n(100)
model <- glm(data=traing_set, was_all_star~(BA+OBP+SLG), family=binomial)
model %>% tidy() %>% knitr::kable(digits=4)
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
model <- glm(data=traing_set, was_all_star~(OBP+SLG), family=binomial)
model %>% tidy() %>% knitr::kable(digits=4)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(100)
prediction <- as.vector(ifelse(predict(model, test_set %>% select(OBP,SLG)) >= 0, 1, 0))
test_set$pred <- prediction
test_set
loss_function <- function (vector1, vector2) {
vector1 <- as.vector(vector1)
vector2 <- as.vector(vector2)
correct <- 0.0
for (i in 1:length(vector1)) {
if (vector1[i] == vector2[i]) {
correct <- correct+1.0
}
}
return (correct/length(vector1))
}
loss_function(test_set$was_all_star, test_set$pred)
size <- nrow(traing_set)
for (i in 1:size-2) {
for (j in i+1:size-1) {
for (k in j+1:size) {
print(i)
print(j)
print(k)
}
}
}
size <- nrow(traing_set)
size <- ncol(traing_set)
size <- ncol(traing_set)
for (i in 1:size-2) {
for (j in i+1:size-1) {
for (k in j+1:size) {
print(i)
print(j)
print(k)
}
}
}
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
model1 <- glm(data=traing_set, was_all_star~(OBP+SLG), family=binomial)
prediction <- as.vector(ifelse(predict(model, test_set %>% select(OBP,SLG)) >= 0, 1, 0))
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(100)
model1 <- glm(data=traing_set, was_all_star~(OBP+SLG), family=binomial)
prediction1 <- as.vector(ifelse(predict(model, test_set %>% select(OBP,SLG)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(OBP+SLG), family=binomial)
prediction2 <- as.vector(ifelse(predict(model, test_set %>% select(OBP,SLG)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(OBP+SLG), family=binomial)
prediction3 <- as.vector(ifelse(predict(model, test_set %>% select(OBP,SLG)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG), family=binomial)
prediction4 <- as.vector(ifelse(predict(model, test_set %>% select(OBP,SLG)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(OBP+SLG), family=binomial)
prediction5 <- as.vector(ifelse(predict(model, test_set %>% select(OBP,SLG)) >= 0, 1, 0))
View(allstar_stats_trimed)
prediction1 <- as.vector(ifelse(predict(model, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(100)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(100)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
loss_function(test_set$was_all_star, model1)
loss_function(test_set$was_all_star, prediction1)
loss_function(test_set$was_all_star, prediction2)
loss_function(test_set$was_all_star, prediction3)
loss_function(test_set$was_all_star, prediction4)
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(100)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
loss_function(test_set$was_all_star, prediction1)
loss_function(test_set$was_all_star, prediction2)
loss_function(test_set$was_all_star, prediction3)
loss_function(test_set$was_all_star, prediction4)
loss_function(test_set$was_all_star, prediction5)
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(100)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
loss_function(test_set$was_all_star, prediction1)
loss_function(test_set$was_all_star, prediction2)
loss_function(test_set$was_all_star, prediction3)
loss_function(test_set$was_all_star, prediction4)
loss_function(test_set$was_all_star, prediction5)
traing_set <- allstar_stats_trimed %>% sample_n(100) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(100)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
loss_function(test_set$was_all_star, prediction1)
loss_function(test_set$was_all_star, prediction2)
loss_function(test_set$was_all_star, prediction3)
loss_function(test_set$was_all_star, prediction4)
loss_function(test_set$was_all_star, prediction5)
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
loss_function(test_set$was_all_star, prediction1)
loss_function(test_set$was_all_star, prediction2)
loss_function(test_set$was_all_star, prediction3)
loss_function(test_set$was_all_star, prediction4)
loss_function(test_set$was_all_star, prediction5)
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
loss_function(test_set$was_all_star, prediction1)
loss_function(test_set$was_all_star, prediction2)
loss_function(test_set$was_all_star, prediction3)
loss_function(test_set$was_all_star, prediction4)
loss_function(test_set$was_all_star, prediction5)
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
loss_function(test_set$was_all_star, prediction1)
loss_function(test_set$was_all_star, prediction2)
loss_function(test_set$was_all_star, prediction3)
loss_function(test_set$was_all_star, prediction4)
loss_function(test_set$was_all_star, prediction5)
View(players)
times = 10
stats <- c()
type <- c()
for (i in 1:times) {
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
stats <- append(stats,loss_function(test_set$was_all_star, prediction1))
stats <- append(stats,loss_function(test_set$was_all_star, prediction2))
stats <- append(stats,loss_function(test_set$was_all_star, prediction3))
stats <- append(stats,loss_function(test_set$was_all_star, prediction4))
stats <- append(stats,loss_function(test_set$was_all_star, prediction5))
type <- append(type,'one')
type <- append(type,'two')
type <- append(type,'three')
type <- append(type,'four')
type <- append(type,'five')
}
stats
frm <- as.data.frame(stats,type)
frm
frm <- as.data.frame(stats)
frm
frm$lbl <- type
frm
frm %>% ggplot(mapping=aes(x=lbl,y=stats)) + geom_point()
frm %>% ggplot(mapping=aes(x=lbl,y=stats)) + geom_point()
times = 10
stats <- c()
type <- c()
for (i in 1:times) {
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
stats <- append(stats,loss_function(test_set$was_all_star, prediction1))
stats <- append(stats,loss_function(test_set$was_all_star, prediction2))
stats <- append(stats,loss_function(test_set$was_all_star, prediction3))
stats <- append(stats,loss_function(test_set$was_all_star, prediction4))
stats <- append(stats,loss_function(test_set$was_all_star, prediction5))
type <- append(type,'one')
type <- append(type,'two')
type <- append(type,'three')
type <- append(type,'four')
type <- append(type,'five')
}
frm <- as.data.frame(stats)
frm$lbl <- type
frm %>% ggplot(mapping=aes(x=lbl,y=stats)) + geom_point()
times = 10
stats <- c()
type <- c()
for (i in 1:times) {
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
stats <- append(stats,loss_function(test_set$was_all_star, prediction1))
stats <- append(stats,loss_function(test_set$was_all_star, prediction2))
stats <- append(stats,loss_function(test_set$was_all_star, prediction3))
stats <- append(stats,loss_function(test_set$was_all_star, prediction4))
stats <- append(stats,loss_function(test_set$was_all_star, prediction5))
type <- append(type,'one')
type <- append(type,'two')
type <- append(type,'three')
type <- append(type,'four')
type <- append(type,'five')
}
frm <- as.data.frame(stats)
frm$lbl <- type
frm %>% ggplot(mapping=aes(x=lbl,y=stats)) + geom_point()
times = 10
stats <- c()
type <- c()
for (i in 1:times) {
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
stats <- append(stats,loss_function(test_set$was_all_star, prediction1))
stats <- append(stats,loss_function(test_set$was_all_star, prediction2))
stats <- append(stats,loss_function(test_set$was_all_star, prediction3))
stats <- append(stats,loss_function(test_set$was_all_star, prediction4))
stats <- append(stats,loss_function(test_set$was_all_star, prediction5))
type <- append(type,1)
type <- append(type,2)
type <- append(type,3)
type <- append(type,4)
type <- append(type,5)
}
frm <- as.data.frame(stats)
frm$lbl <- type
frm %>% ggplot(mapping=aes(x=lbl,y=stats)) + geom_point()
times = 10
stats <- c()
type <- c()
for (i in 1:times) {
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
stats <- append(stats,loss_function(test_set$was_all_star, prediction1))
stats <- append(stats,loss_function(test_set$was_all_star, prediction2))
stats <- append(stats,loss_function(test_set$was_all_star, prediction3))
stats <- append(stats,loss_function(test_set$was_all_star, prediction4))
stats <- append(stats,loss_function(test_set$was_all_star, prediction5))
type <- append(type,1)
type <- append(type,2)
type <- append(type,3)
type <- append(type,4)
type <- append(type,5)
}
frm <- as.data.frame(stats)
frm$lbl <- type
frm %>% ggplot(mapping=aes(x=lbl,y=stats)) + geom_point()
times = 10
stats <- c()
type <- c()
for (i in 1:times) {
traing_set <- allstar_stats_trimed %>% sample_n(500) %>% filter(ab > 100)
test_set <- allstar_stats_trimed %>% ungroup() %>% filter(ab > 100) %>% sample_n(500)
model1 <- glm(data=traing_set, was_all_star~(hr+rbi+r), family=binomial)
prediction1 <- as.vector(ifelse(predict(model1, test_set %>% select(hr,rbi,r)) >= 0, 1, 0))
model2 <- glm(data=traing_set, was_all_star~(h+hr+k), family=binomial)
prediction2 <- as.vector(ifelse(predict(model2, test_set %>% select(h,hr,k)) >= 0, 1, 0))
model3 <- glm(data=traing_set, was_all_star~(HRpercent+BBpercent+Kpercent), family=binomial)
prediction3 <- as.vector(ifelse(predict(model3, test_set %>% select(HRpercent,BBpercent,Kpercent)) >= 0, 1, 0))
model4 <- glm(data=traing_set, was_all_star~(OBP+SLG+h), family=binomial)
prediction4 <- as.vector(ifelse(predict(model4, test_set %>% select(OBP,SLG,h)) >= 0, 1, 0))
model5 <- glm(data=traing_set, was_all_star~(bb+d+ISO), family=binomial)
prediction5 <- as.vector(ifelse(predict(model5, test_set %>% select(bb,d,ISO)) >= 0, 1, 0))
stats <- append(stats,loss_function(test_set$was_all_star, prediction1))
stats <- append(stats,loss_function(test_set$was_all_star, prediction2))
stats <- append(stats,loss_function(test_set$was_all_star, prediction3))
stats <- append(stats,loss_function(test_set$was_all_star, prediction4))
stats <- append(stats,loss_function(test_set$was_all_star, prediction5))
type <- append(type,1)
type <- append(type,2)
type <- append(type,3)
type <- append(type,4)
type <- append(type,5)
}
frm <- as.data.frame(stats)
frm$lbl <- type
frm %>% ggplot(mapping=aes(x=lbl,y=stats)) + geom_point()
